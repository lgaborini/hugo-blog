---
title: "Viewing scraped HTML sessions from rvest and friends"
draft: false
categories: ["coding"]
tags: ["R", "rvest", "httr", "S3"]
date: "2018-01-17"
editor_options: 
  chunk_output_type: console
---



<p>Hadley Wickham’s excellent {{<cran rvest>}} R package is an extremely easy way to scrape any HTML page.<br />
It also provides limited utilities to do the scraping interactively:</p>
<ul>
<li><code>html_session</code>, which actually starts a browsing session in R interpreter,</li>
<li><code>back</code>, <code>follow_link</code>, <code>jump_to</code> implement page navigation using history or link selectors (CSS/XPath)</li>
<li><code>html_nodes</code> accept <code>session</code> objects and return HTML nodes in <code>rvest</code>-friendly format</li>
</ul>
<p>However, there is no easy way to see the code which is actually parsed.<br />
Since {{<cran rvest>}} uses {{<cran httr>}} to make HTML requests, returned code can be very different from what is seen on a browser.</p>
<p>Similar issues exist even if you use other R packages such as {{<cran httr>}} (which, basically, deals only with the HTTP requests), {{<cran curl>}} or {{<cran RCurl>}} (same, but the hard way!).</p>
<p>In this post, we provide some quick functions to access the HTML code and view it in a browser. We will also learn how to exploit the S3 object system in R to help us!</p>
<div id="using-rvest" class="section level3">
<h3>Using <code>rvest</code></h3>
<p>Suppose that we have just scraped a page:</p>
<pre class="r"><code>library(xml2)
library(rvest)

url &lt;- &#39;https://nghttp2.org/httpbin/&#39;
s &lt;- rvest::html_session(url)
class(s)
## [1] &quot;session&quot;</code></pre>
<p><code>s</code> holds the scraped page (it is a <code>session</code>-object), we can access the page contents using <code>xml2::read_html()</code>:</p>
<pre class="r"><code>s_tree &lt;- xml2::read_html(s)
class(s_tree)
## [1] &quot;xml_document&quot; &quot;xml_node&quot;
s_tree
## {xml_document}
## &lt;html&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset= ...
## [2] &lt;body id=&quot;manpage&quot;&gt;\n&lt;a href=&quot;http://github.com/Runscope/httpbin&quot;&gt;&lt;i ...</code></pre>
<p>We can see that <code>s_tree</code> has class <code>xml2::xml_document</code>, but the code is still hidden. The function <code>as.character</code> helps:</p>
<pre class="r"><code>as.character(s_tree)
## [1] &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta http-equiv=\&quot;Content-Type\&quot; content=\&quot;text/html; charset=UTF-8\&quot;&gt;\n&lt;meta http-equiv=\&quot;content-type\&quot; value=\&quot;text/html;charset=utf8\&quot;&gt;\n&lt;meta name=\&quot;generator\&quot; value=\&quot;Ronn/v0.7.3 (http://github.com/rtomayko/ronn/tree/0.7.3)\&quot;&gt;\n&lt;title&gt;httpbin(1): HTTP Client Testing Service&lt;/title&gt;\n&lt;style type=\&quot;text/css\&quot; media=\&quot;all\&quot;&gt;\n  /* style: man */\n  body#manpage {margin:0}\n  .mp {max-width:100ex;padding:0 9ex 1ex 4ex}\n  .mp p,.mp pre,.mp ul,.mp ol,.mp dl {margin:0 0 20px 0}\n  .mp h2 {margin:10px 0 0 0}\n  .mp &gt; p,.mp &gt; pre,.mp &gt; ul,.mp &gt; ol,.mp &gt; dl {margin-left:8ex}\n  .mp h3 {margin:0 0 0 4ex}\n  .mp dt {margin:0;clear:left}\n  .mp dt.flush {float:left;width:8ex}\n  .mp dd {margin:0 0 0 9ex}\n  .mp h1,.mp h2,.mp h3,.mp h4 {clear:left}\n  .mp pre {margin-bottom:20px}\n  .mp pre+h2,.mp pre+h3 {margin-top:22px}\n  .mp h2+pre,.mp h3+pre {margin-top:5px}\n  .mp img {display:block;margin:auto}\n  .mp h1.man-title {display:none}\n  .mp,.mp code,.mp pre,.mp tt,.mp kbd,.mp samp,.mp h3,.mp h4 {font-family:monospace;font-size:14px;line-height:1.42857142857143}\n  .mp h2 {font-size:16px;line-height:1.25}\n  .mp h1 {font-size:20px;line-height:2}\n  .mp {text-align:justify;background:#fff}\n  .mp,.mp code,.mp pre,.mp pre code,.mp tt,.mp kbd,.mp samp {color:#131211}\n  .mp h1,.mp h2,.mp h3,.mp h4 {color:#030201}\n  .mp u {text-decoration:underline}\n  .mp code,.mp strong,.mp b {font-weight:bold;color:#131211}\n  .mp em,.mp var {font-style:italic;color:#232221;text-decoration:none}\n  .mp a,.mp a:link,.mp a:hover,.mp a code,.mp a pre,.mp a tt,.mp a kbd,.mp a samp {color:#0000ff}\n  .mp b.man-ref {font-weight:normal;color:#434241}\n  .mp pre {padding:0 4ex}\n  .mp pre code {font-weight:normal;color:#434241}\n  .mp h2+pre,h3+pre {padding-left:0}\n  ol.man-decor,ol.man-decor li {margin:3px 0 10px 0;padding:0;float:left;width:33%;list-style-type:none;text-transform:uppercase;color:#999;letter-spacing:1px}\n  ol.man-decor {width:100%}\n  ol.man-decor li.tl {text-align:left}\n  ol.man-decor li.tc {text-align:center;letter-spacing:4px}\n  ol.man-decor li.tr {text-align:right;float:right}\n  &lt;/style&gt;\n&lt;style type=\&quot;text/css\&quot; media=\&quot;all\&quot;&gt;\n  /* style: 80c */\n  .mp {max-width:86ex}\n  ul {list-style: None; margin-left: 1em!important}\n  .man-navigation {left:101ex}\n  &lt;/style&gt;\n&lt;/head&gt;\n&lt;body id=\&quot;manpage\&quot;&gt;\n&lt;a href=\&quot;http://github.com/Runscope/httpbin\&quot;&gt;&lt;img style=\&quot;position: absolute; top: 0; right: 0; border: 0;\&quot; src=\&quot;https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png\&quot; alt=\&quot;Fork me on GitHub\&quot;&gt;&lt;/a&gt;\n\n\n\n&lt;div class=\&quot;mp\&quot;&gt;\n&lt;h1&gt;httpbin(1): HTTP Request &amp;amp; Response Service&lt;/h1&gt;\n&lt;p&gt;HTTP/2, SPDY and HTTP/1.1 clients are supported.&lt;/p&gt;\n\n&lt;h2 id=\&quot;ENDPOINTS\&quot;&gt;ENDPOINTS&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/&lt;/code&gt;&lt;/a&gt; This page.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/ip\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/ip&lt;/code&gt;&lt;/a&gt; Returns Origin IP.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/user-agent\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/user-agent&lt;/code&gt;&lt;/a&gt; Returns user-agent.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/headers\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/headers&lt;/code&gt;&lt;/a&gt; Returns header dict.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/get\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/get&lt;/code&gt;&lt;/a&gt; Returns GET data.&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;/post&lt;/code&gt; Returns POST data.&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;/patch&lt;/code&gt; Returns PATCH data.&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;/put&lt;/code&gt; Returns PUT data.&lt;/li&gt;\n&lt;li&gt;\n&lt;code&gt;/delete&lt;/code&gt; Returns DELETE data&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/encoding/utf8\&quot;&gt;&lt;code&gt;/encoding/utf8&lt;/code&gt;&lt;/a&gt; Returns page containing UTF-8 data.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/gzip\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/gzip&lt;/code&gt;&lt;/a&gt; Returns gzip-encoded data.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/deflate\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/deflate&lt;/code&gt;&lt;/a&gt; Returns deflate-encoded data.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/status/418\&quot;&gt;&lt;code&gt;/status/:code&lt;/code&gt;&lt;/a&gt; Returns given HTTP Status code.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/response-headers?Content-Type=text%2Fplain%3B+charset%3DUTF-8&amp;amp;Server=httpbin\&quot;&gt;&lt;code&gt;/response-headers?key=val&lt;/code&gt;&lt;/a&gt; Returns given response headers.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/redirect/6\&quot;&gt;&lt;code&gt;/redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/redirect-to?url=http%3A%2F%2Fexample.com%2F\&quot;&gt;&lt;code&gt;/redirect-to?url=foo&lt;/code&gt;&lt;/a&gt; 302 Redirects to the &lt;em&gt;foo&lt;/em&gt; URL.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/relative-redirect/6\&quot;&gt;&lt;code&gt;/relative-redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Relative redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/absolute-redirect/6\&quot;&gt;&lt;code&gt;/absolute-redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Absolute redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/cookies\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/cookies&lt;/code&gt;&lt;/a&gt; Returns cookie data.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/cookies/set?k2=v2&amp;amp;k1=v1\&quot;&gt;&lt;code&gt;/cookies/set?name=value&lt;/code&gt;&lt;/a&gt; Sets one or more simple cookies.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/cookies/delete?k2=&amp;amp;k1=\&quot;&gt;&lt;code&gt;/cookies/delete?name&lt;/code&gt;&lt;/a&gt; Deletes one or more simple cookies.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/basic-auth/user/passwd\&quot;&gt;&lt;code&gt;/basic-auth/:user/:passwd&lt;/code&gt;&lt;/a&gt; Challenges HTTPBasic Auth.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/hidden-basic-auth/user/passwd\&quot;&gt;&lt;code&gt;/hidden-basic-auth/:user/:passwd&lt;/code&gt;&lt;/a&gt; 404&#39;d BasicAuth.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/digest-auth/auth/user/passwd\&quot;&gt;&lt;code&gt;/digest-auth/:qop/:user/:passwd&lt;/code&gt;&lt;/a&gt; Challenges HTTP Digest Auth.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/stream/20\&quot;&gt;&lt;code&gt;/stream/:n&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt;–100 lines.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/delay/3\&quot;&gt;&lt;code&gt;/delay/:n&lt;/code&gt;&lt;/a&gt; Delays responding for &lt;em&gt;n&lt;/em&gt;–10 seconds.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/drip?duration=5&amp;amp;numbytes=5&amp;amp;code=200\&quot;&gt;&lt;code&gt;/drip?numbytes=n&amp;amp;duration=s&amp;amp;delay=s&amp;amp;code=code&lt;/code&gt;&lt;/a&gt; Drips data over a duration after an optional initial delay, then (optionally) returns with the given status code.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/range/1024\&quot;&gt;&lt;code&gt;/range/1024?duration=s&amp;amp;chunk_size=code&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt; bytes, and allows specifying a &lt;em&gt;Range&lt;/em&gt; header to select a subset of the data. Accepts a &lt;em&gt;chunk_size&lt;/em&gt; and request &lt;em&gt;duration&lt;/em&gt; parameter.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/html\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/html&lt;/code&gt;&lt;/a&gt; Renders an HTML Page.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/robots.txt\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/robots.txt&lt;/code&gt;&lt;/a&gt; Returns some robots.txt rules.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/deny\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/deny&lt;/code&gt;&lt;/a&gt; Denied by robots.txt file.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/cache\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/cache&lt;/code&gt;&lt;/a&gt; Returns 200 unless an If-Modified-Since or If-None-Match header is provided, when it returns a 304.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/cache/60\&quot;&gt;&lt;code&gt;/cache/:n&lt;/code&gt;&lt;/a&gt; Sets a Cache-Control header for &lt;em&gt;n&lt;/em&gt; seconds.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/bytes/1024\&quot;&gt;&lt;code&gt;/bytes/:n&lt;/code&gt;&lt;/a&gt; Generates &lt;em&gt;n&lt;/em&gt; random bytes of binary data, accepts optional &lt;em&gt;seed&lt;/em&gt; integer parameter.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/stream-bytes/1024\&quot;&gt;&lt;code&gt;/stream-bytes/:n&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt; random bytes of binary data, accepts optional &lt;em&gt;seed&lt;/em&gt; and &lt;em&gt;chunk_size&lt;/em&gt; integer parameters.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/links/10\&quot;&gt;&lt;code&gt;/links/:n&lt;/code&gt;&lt;/a&gt; Returns page containing &lt;em&gt;n&lt;/em&gt; HTML links.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/image\&quot;&gt;&lt;code&gt;/image&lt;/code&gt;&lt;/a&gt; Returns page containing an image.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/image/png\&quot;&gt;&lt;code&gt;/image/png&lt;/code&gt;&lt;/a&gt; Returns page containing a PNG image.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/image/jpeg\&quot;&gt;&lt;code&gt;/image/jpeg&lt;/code&gt;&lt;/a&gt; Returns page containing a JPEG image.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/image/webp\&quot;&gt;&lt;code&gt;/image/webp&lt;/code&gt;&lt;/a&gt; Returns page containing a WEBP image.&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/forms/post\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/forms/post&lt;/code&gt;&lt;/a&gt; HTML form that submits to &lt;em&gt;/post&lt;/em&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;a href=\&quot;/httpbin/xml\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/xml&lt;/code&gt;&lt;/a&gt; Returns some XML&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;DESCRIPTION\&quot;&gt;DESCRIPTION&lt;/h2&gt;\n\n&lt;p&gt;Testing an HTTP Library can become difficult sometimes. &lt;a href=\&quot;http://requestb.in\&quot;&gt;RequestBin&lt;/a&gt; is fantastic for testing POST requests, but doesn&#39;t let you control the response. This exists to cover all kinds of HTTP scenarios. Additional endpoints are being considered.&lt;/p&gt;\n\n&lt;p&gt;All endpoint responses are JSON-encoded.&lt;/p&gt;\n\n&lt;h2 id=\&quot;EXAMPLES\&quot;&gt;EXAMPLES&lt;/h2&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-ip\&quot;&gt;$ curl http://httpbin.org/ip&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\&quot;origin\&quot;: \&quot;24.127.96.129\&quot;}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-user-agent\&quot;&gt;$ curl http://httpbin.org/user-agent&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\&quot;user-agent\&quot;: \&quot;curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8l zlib/1.2.3\&quot;}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-get\&quot;&gt;$ curl http://httpbin.org/get&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\n   \&quot;args\&quot;: {},\n   \&quot;headers\&quot;: {\n      \&quot;Accept\&quot;: \&quot;*/*\&quot;,\n      \&quot;Connection\&quot;: \&quot;close\&quot;,\n      \&quot;Content-Length\&quot;: \&quot;\&quot;,\n      \&quot;Content-Type\&quot;: \&quot;\&quot;,\n      \&quot;Host\&quot;: \&quot;httpbin.org\&quot;,\n      \&quot;User-Agent\&quot;: \&quot;curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8l zlib/1.2.3\&quot;\n   },\n   \&quot;origin\&quot;: \&quot;24.127.96.129\&quot;,\n   \&quot;url\&quot;: \&quot;http://httpbin.org/get\&quot;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-I-http-httpbin-org-status-418\&quot;&gt;$ curl -I http://httpbin.org/status/418&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;HTTP/1.1 418 I&#39;M A TEAPOT\nServer: nginx/0.7.67\nDate: Mon, 13 Jun 2011 04:25:38 GMT\nConnection: close\nx-more-info: http://tools.ietf.org/html/rfc2324\nContent-Length: 135\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-https-httpbin-org-get-show_env-1\&quot;&gt;$ curl https://httpbin.org/get?show_env=1&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\n  \&quot;headers\&quot;: {\n    \&quot;Content-Length\&quot;: \&quot;\&quot;,\n    \&quot;Accept-Language\&quot;: \&quot;en-US,en;q=0.8\&quot;,\n    \&quot;Accept-Encoding\&quot;: \&quot;gzip,deflate,sdch\&quot;,\n    \&quot;X-Forwarded-Port\&quot;: \&quot;443\&quot;,\n    \&quot;X-Forwarded-For\&quot;: \&quot;109.60.101.240\&quot;,\n    \&quot;Host\&quot;: \&quot;httpbin.org\&quot;,\n    \&quot;Accept\&quot;: \&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\&quot;,\n    \&quot;User-Agent\&quot;: \&quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.83 Safari/535.11\&quot;,\n    \&quot;X-Request-Start\&quot;: \&quot;1350053933441\&quot;,\n    \&quot;Accept-Charset\&quot;: \&quot;ISO-8859-1,utf-8;q=0.7,*;q=0.3\&quot;,\n    \&quot;Connection\&quot;: \&quot;keep-alive\&quot;,\n    \&quot;X-Forwarded-Proto\&quot;: \&quot;https\&quot;,\n    \&quot;Cookie\&quot;: \&quot;_gauges_unique_day=1; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1; _gauges_unique_hour=1\&quot;,\n    \&quot;Content-Type\&quot;: \&quot;\&quot;\n  },\n  \&quot;args\&quot;: {\n    \&quot;show_env\&quot;: \&quot;1\&quot;\n  },\n  \&quot;origin\&quot;: \&quot;109.60.101.240\&quot;,\n  \&quot;url\&quot;: \&quot;http://httpbin.org/get?show_env=1\&quot;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2 id=\&quot;Installing-and-running-from-PyPI\&quot;&gt;Installing and running from PyPI&lt;/h2&gt;\n\n&lt;p&gt;You can install httpbin as a library from PyPI and run it as a WSGI app.  For example, using Gunicorn:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code class=\&quot;bash\&quot;&gt;$ pip install httpbin\n$ gunicorn httpbin:app\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2 id=\&quot;Changelog\&quot;&gt;Changelog&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;0.2.0: Added an XML endpoint.  Also fixes several bugs with unicode, CORS headers, digest auth, and more.&lt;/li&gt;\n&lt;li&gt;0.1.2: Fix a couple Python3 bugs with the random byte endpoints, fix a bug when uploading files without a Content-Type header set.&lt;/li&gt;\n&lt;li&gt;0.1.1: Added templates as data in setup.py&lt;/li&gt;\n&lt;li&gt;0.1.0: Added python3 support and (re)publish on PyPI&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;AUTHOR\&quot;&gt;AUTHOR&lt;/h2&gt;\n\n&lt;p&gt;A &lt;a href=\&quot;https://www.runscope.com/community\&quot;&gt;Runscope Community Project&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Originally created by &lt;a href=\&quot;http://kennethreitz.com/\&quot;&gt;Kenneth Reitz&lt;/a&gt;.&lt;/p&gt;\n\n&lt;h2 id=\&quot;SEE-ALSO\&quot;&gt;SEE ALSO&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\&quot;https://www.hurl.it\&quot;&gt;Hurl.it&lt;/a&gt; - Make HTTP requests.&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&quot;http://requestb.in\&quot;&gt;RequestBin&lt;/a&gt; - Inspect HTTP requests.&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&quot;http://python-requests.org\&quot; data-bare-link=\&quot;true\&quot;&gt;http://python-requests.org&lt;/a&gt;&lt;/p&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;</code></pre>
<p>Here it is! Now we want to view it on a browser.</p>
<p>R <code>base</code> package contains the function <code>browseURL()</code>, which however opens the browser to an URL or a file. So we have to store it on disk.</p>
<p>Let’s create a function which does all of this: getting a <code>session</code> object, extracting the HTML code, casting to character, writing it to disk and taking care of cleaning the output.</p>
<pre class="r"><code>view_rvest &lt;- function(s) {

   # Cast the session to character
   stopifnot(class(s) == &#39;session&#39;)
   s_tree &lt;- xml2::read_html(s)
   s_code &lt;- as.character(s_tree)
   
   # Make a temporary file, fill it with text
   temp_file &lt;- tempfile(fileext = &#39;.html&#39;)

   f &lt;- file(temp_file, open = &#39;w&#39;)
   write(s_code, f)
   close(f)
   
   browseURL(temp_file)

   # Wait a while, then delete it
   Sys.sleep(3)
   unlink(temp_file)
}

view_rvest(s)</code></pre>
<p>And voilà!</p>
</div>
<div id="using-httr" class="section level3">
<h3>Using <code>httr</code></h3>
<p>Suppose, now, that we want to do the same with an <code>httr</code> request.<br />
E.g., the code from the previous page can be retrieved by:</p>
<pre class="r"><code>req &lt;- httr::GET(url)
httr::content(req, as = &#39;text&#39;)
## [1] &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta http-equiv=&#39;content-type&#39; value=&#39;text/html;charset=utf8&#39;&gt;\n  &lt;meta name=&#39;generator&#39; value=&#39;Ronn/v0.7.3 (http://github.com/rtomayko/ronn/tree/0.7.3)&#39;&gt;\n  &lt;title&gt;httpbin(1): HTTP Client Testing Service&lt;/title&gt;\n  &lt;style type=&#39;text/css&#39; media=&#39;all&#39;&gt;\n  /* style: man */\n  body#manpage {margin:0}\n  .mp {max-width:100ex;padding:0 9ex 1ex 4ex}\n  .mp p,.mp pre,.mp ul,.mp ol,.mp dl {margin:0 0 20px 0}\n  .mp h2 {margin:10px 0 0 0}\n  .mp &gt; p,.mp &gt; pre,.mp &gt; ul,.mp &gt; ol,.mp &gt; dl {margin-left:8ex}\n  .mp h3 {margin:0 0 0 4ex}\n  .mp dt {margin:0;clear:left}\n  .mp dt.flush {float:left;width:8ex}\n  .mp dd {margin:0 0 0 9ex}\n  .mp h1,.mp h2,.mp h3,.mp h4 {clear:left}\n  .mp pre {margin-bottom:20px}\n  .mp pre+h2,.mp pre+h3 {margin-top:22px}\n  .mp h2+pre,.mp h3+pre {margin-top:5px}\n  .mp img {display:block;margin:auto}\n  .mp h1.man-title {display:none}\n  .mp,.mp code,.mp pre,.mp tt,.mp kbd,.mp samp,.mp h3,.mp h4 {font-family:monospace;font-size:14px;line-height:1.42857142857143}\n  .mp h2 {font-size:16px;line-height:1.25}\n  .mp h1 {font-size:20px;line-height:2}\n  .mp {text-align:justify;background:#fff}\n  .mp,.mp code,.mp pre,.mp pre code,.mp tt,.mp kbd,.mp samp {color:#131211}\n  .mp h1,.mp h2,.mp h3,.mp h4 {color:#030201}\n  .mp u {text-decoration:underline}\n  .mp code,.mp strong,.mp b {font-weight:bold;color:#131211}\n  .mp em,.mp var {font-style:italic;color:#232221;text-decoration:none}\n  .mp a,.mp a:link,.mp a:hover,.mp a code,.mp a pre,.mp a tt,.mp a kbd,.mp a samp {color:#0000ff}\n  .mp b.man-ref {font-weight:normal;color:#434241}\n  .mp pre {padding:0 4ex}\n  .mp pre code {font-weight:normal;color:#434241}\n  .mp h2+pre,h3+pre {padding-left:0}\n  ol.man-decor,ol.man-decor li {margin:3px 0 10px 0;padding:0;float:left;width:33%;list-style-type:none;text-transform:uppercase;color:#999;letter-spacing:1px}\n  ol.man-decor {width:100%}\n  ol.man-decor li.tl {text-align:left}\n  ol.man-decor li.tc {text-align:center;letter-spacing:4px}\n  ol.man-decor li.tr {text-align:right;float:right}\n  &lt;/style&gt;\n  &lt;style type=&#39;text/css&#39; media=&#39;all&#39;&gt;\n  /* style: 80c */\n  .mp {max-width:86ex}\n  ul {list-style: None; margin-left: 1em!important}\n  .man-navigation {left:101ex}\n  &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body id=&#39;manpage&#39;&gt;\n&lt;a href=\&quot;http://github.com/Runscope/httpbin\&quot;&gt;&lt;img style=\&quot;position: absolute; top: 0; right: 0; border: 0;\&quot; src=\&quot;https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png\&quot; alt=\&quot;Fork me on GitHub\&quot;&gt;&lt;/a&gt;\n\n\n\n&lt;div class=&#39;mp&#39;&gt;\n&lt;h1&gt;httpbin(1): HTTP Request &amp;amp; Response Service&lt;/h1&gt;\n&lt;p&gt;HTTP/2, SPDY and HTTP/1.1 clients are supported.&lt;/p&gt;\n\n&lt;h2 id=\&quot;ENDPOINTS\&quot;&gt;ENDPOINTS&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/&lt;/code&gt;&lt;/a&gt; This page.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/ip\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/ip&lt;/code&gt;&lt;/a&gt; Returns Origin IP.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/user-agent\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/user-agent&lt;/code&gt;&lt;/a&gt; Returns user-agent.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/headers\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/headers&lt;/code&gt;&lt;/a&gt; Returns header dict.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/get\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/get&lt;/code&gt;&lt;/a&gt; Returns GET data.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;/post&lt;/code&gt; Returns POST data.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;/patch&lt;/code&gt; Returns PATCH data.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;/put&lt;/code&gt; Returns PUT data.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;/delete&lt;/code&gt; Returns DELETE data&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/encoding/utf8\&quot;&gt;&lt;code&gt;/encoding/utf8&lt;/code&gt;&lt;/a&gt; Returns page containing UTF-8 data.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/gzip\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/gzip&lt;/code&gt;&lt;/a&gt; Returns gzip-encoded data.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/deflate\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/deflate&lt;/code&gt;&lt;/a&gt; Returns deflate-encoded data.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/status/418\&quot;&gt;&lt;code&gt;/status/:code&lt;/code&gt;&lt;/a&gt; Returns given HTTP Status code.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/response-headers?Content-Type=text%2Fplain%3B+charset%3DUTF-8&amp;amp;Server=httpbin\&quot;&gt;&lt;code&gt;/response-headers?key=val&lt;/code&gt;&lt;/a&gt; Returns given response headers.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/redirect/6\&quot;&gt;&lt;code&gt;/redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/redirect-to?url=http%3A%2F%2Fexample.com%2F\&quot;&gt;&lt;code&gt;/redirect-to?url=foo&lt;/code&gt;&lt;/a&gt; 302 Redirects to the &lt;em&gt;foo&lt;/em&gt; URL.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/relative-redirect/6\&quot;&gt;&lt;code&gt;/relative-redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Relative redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/absolute-redirect/6\&quot;&gt;&lt;code&gt;/absolute-redirect/:n&lt;/code&gt;&lt;/a&gt; 302 Absolute redirects &lt;em&gt;n&lt;/em&gt; times.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/cookies\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/cookies&lt;/code&gt;&lt;/a&gt; Returns cookie data.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/cookies/set?k2=v2&amp;amp;k1=v1\&quot;&gt;&lt;code&gt;/cookies/set?name=value&lt;/code&gt;&lt;/a&gt; Sets one or more simple cookies.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/cookies/delete?k2=&amp;amp;k1=\&quot;&gt;&lt;code&gt;/cookies/delete?name&lt;/code&gt;&lt;/a&gt; Deletes one or more simple cookies.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/basic-auth/user/passwd\&quot;&gt;&lt;code&gt;/basic-auth/:user/:passwd&lt;/code&gt;&lt;/a&gt; Challenges HTTPBasic Auth.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/hidden-basic-auth/user/passwd\&quot;&gt;&lt;code&gt;/hidden-basic-auth/:user/:passwd&lt;/code&gt;&lt;/a&gt; 404&#39;d BasicAuth.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/digest-auth/auth/user/passwd\&quot;&gt;&lt;code&gt;/digest-auth/:qop/:user/:passwd&lt;/code&gt;&lt;/a&gt; Challenges HTTP Digest Auth.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/stream/20\&quot;&gt;&lt;code&gt;/stream/:n&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt;–100 lines.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/delay/3\&quot;&gt;&lt;code&gt;/delay/:n&lt;/code&gt;&lt;/a&gt; Delays responding for &lt;em&gt;n&lt;/em&gt;–10 seconds.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/drip?duration=5&amp;amp;numbytes=5&amp;amp;code=200\&quot;&gt;&lt;code&gt;/drip?numbytes=n&amp;amp;duration=s&amp;amp;delay=s&amp;amp;code=code&lt;/code&gt;&lt;/a&gt; Drips data over a duration after an optional initial delay, then (optionally) returns with the given status code.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/range/1024\&quot;&gt;&lt;code&gt;/range/1024?duration=s&amp;amp;chunk_size=code&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt; bytes, and allows specifying a &lt;em&gt;Range&lt;/em&gt; header to select a subset of the data. Accepts a &lt;em&gt;chunk_size&lt;/em&gt; and request &lt;em&gt;duration&lt;/em&gt; parameter.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/html\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/html&lt;/code&gt;&lt;/a&gt; Renders an HTML Page.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/robots.txt\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/robots.txt&lt;/code&gt;&lt;/a&gt; Returns some robots.txt rules.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/deny\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/deny&lt;/code&gt;&lt;/a&gt; Denied by robots.txt file.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/cache\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/cache&lt;/code&gt;&lt;/a&gt; Returns 200 unless an If-Modified-Since or If-None-Match header is provided, when it returns a 304.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/cache/60\&quot;&gt;&lt;code&gt;/cache/:n&lt;/code&gt;&lt;/a&gt; Sets a Cache-Control header for &lt;em&gt;n&lt;/em&gt; seconds.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/bytes/1024\&quot;&gt;&lt;code&gt;/bytes/:n&lt;/code&gt;&lt;/a&gt; Generates &lt;em&gt;n&lt;/em&gt; random bytes of binary data, accepts optional &lt;em&gt;seed&lt;/em&gt; integer parameter.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/stream-bytes/1024\&quot;&gt;&lt;code&gt;/stream-bytes/:n&lt;/code&gt;&lt;/a&gt; Streams &lt;em&gt;n&lt;/em&gt; random bytes of binary data, accepts optional &lt;em&gt;seed&lt;/em&gt; and &lt;em&gt;chunk_size&lt;/em&gt; integer parameters.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/links/10\&quot;&gt;&lt;code&gt;/links/:n&lt;/code&gt;&lt;/a&gt; Returns page containing &lt;em&gt;n&lt;/em&gt; HTML links.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/image\&quot;&gt;&lt;code&gt;/image&lt;/code&gt;&lt;/a&gt; Returns page containing an image.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/image/png\&quot;&gt;&lt;code&gt;/image/png&lt;/code&gt;&lt;/a&gt; Returns page containing a PNG image.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/image/jpeg\&quot;&gt;&lt;code&gt;/image/jpeg&lt;/code&gt;&lt;/a&gt; Returns page containing a JPEG image.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/image/webp\&quot;&gt;&lt;code&gt;/image/webp&lt;/code&gt;&lt;/a&gt; Returns page containing a WEBP image.&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/forms/post\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/forms/post&lt;/code&gt;&lt;/a&gt; HTML form that submits to &lt;em&gt;/post&lt;/em&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\&quot;/httpbin/xml\&quot; data-bare-link=\&quot;true\&quot;&gt;&lt;code&gt;/xml&lt;/code&gt;&lt;/a&gt; Returns some XML&lt;/li&gt;\n&lt;/ul&gt;\n\n\n&lt;h2 id=\&quot;DESCRIPTION\&quot;&gt;DESCRIPTION&lt;/h2&gt;\n\n&lt;p&gt;Testing an HTTP Library can become difficult sometimes. &lt;a href=\&quot;http://requestb.in\&quot;&gt;RequestBin&lt;/a&gt; is fantastic for testing POST requests, but doesn&#39;t let you control the response. This exists to cover all kinds of HTTP scenarios. Additional endpoints are being considered.&lt;/p&gt;\n\n&lt;p&gt;All endpoint responses are JSON-encoded.&lt;/p&gt;\n\n&lt;h2 id=\&quot;EXAMPLES\&quot;&gt;EXAMPLES&lt;/h2&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-ip\&quot;&gt;$ curl http://httpbin.org/ip&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\&quot;origin\&quot;: \&quot;24.127.96.129\&quot;}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-user-agent\&quot;&gt;$ curl http://httpbin.org/user-agent&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\&quot;user-agent\&quot;: \&quot;curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8l zlib/1.2.3\&quot;}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-http-httpbin-org-get\&quot;&gt;$ curl http://httpbin.org/get&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\n   \&quot;args\&quot;: {},\n   \&quot;headers\&quot;: {\n      \&quot;Accept\&quot;: \&quot;*/*\&quot;,\n      \&quot;Connection\&quot;: \&quot;close\&quot;,\n      \&quot;Content-Length\&quot;: \&quot;\&quot;,\n      \&quot;Content-Type\&quot;: \&quot;\&quot;,\n      \&quot;Host\&quot;: \&quot;httpbin.org\&quot;,\n      \&quot;User-Agent\&quot;: \&quot;curl/7.19.7 (universal-apple-darwin10.0) libcurl/7.19.7 OpenSSL/0.9.8l zlib/1.2.3\&quot;\n   },\n   \&quot;origin\&quot;: \&quot;24.127.96.129\&quot;,\n   \&quot;url\&quot;: \&quot;http://httpbin.org/get\&quot;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-I-http-httpbin-org-status-418\&quot;&gt;$ curl -I http://httpbin.org/status/418&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;HTTP/1.1 418 I&#39;M A TEAPOT\nServer: nginx/0.7.67\nDate: Mon, 13 Jun 2011 04:25:38 GMT\nConnection: close\nx-more-info: http://tools.ietf.org/html/rfc2324\nContent-Length: 135\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3 id=\&quot;-curl-https-httpbin-org-get-show_env-1\&quot;&gt;$ curl https://httpbin.org/get?show_env=1&lt;/h3&gt;\n\n&lt;pre&gt;&lt;code&gt;{\n  \&quot;headers\&quot;: {\n    \&quot;Content-Length\&quot;: \&quot;\&quot;,\n    \&quot;Accept-Language\&quot;: \&quot;en-US,en;q=0.8\&quot;,\n    \&quot;Accept-Encoding\&quot;: \&quot;gzip,deflate,sdch\&quot;,\n    \&quot;X-Forwarded-Port\&quot;: \&quot;443\&quot;,\n    \&quot;X-Forwarded-For\&quot;: \&quot;109.60.101.240\&quot;,\n    \&quot;Host\&quot;: \&quot;httpbin.org\&quot;,\n    \&quot;Accept\&quot;: \&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\&quot;,\n    \&quot;User-Agent\&quot;: \&quot;Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.83 Safari/535.11\&quot;,\n    \&quot;X-Request-Start\&quot;: \&quot;1350053933441\&quot;,\n    \&quot;Accept-Charset\&quot;: \&quot;ISO-8859-1,utf-8;q=0.7,*;q=0.3\&quot;,\n    \&quot;Connection\&quot;: \&quot;keep-alive\&quot;,\n    \&quot;X-Forwarded-Proto\&quot;: \&quot;https\&quot;,\n    \&quot;Cookie\&quot;: \&quot;_gauges_unique_day=1; _gauges_unique_month=1; _gauges_unique_year=1; _gauges_unique=1; _gauges_unique_hour=1\&quot;,\n    \&quot;Content-Type\&quot;: \&quot;\&quot;\n  },\n  \&quot;args\&quot;: {\n    \&quot;show_env\&quot;: \&quot;1\&quot;\n  },\n  \&quot;origin\&quot;: \&quot;109.60.101.240\&quot;,\n  \&quot;url\&quot;: \&quot;http://httpbin.org/get?show_env=1\&quot;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2 id=\&quot;Installing-and-running-from-PyPI\&quot;&gt;Installing and running from PyPI&lt;/h2&gt;\n\n&lt;p&gt;You can install httpbin as a library from PyPI and run it as a WSGI app.  For example, using Gunicorn:&lt;/p&gt;\n\n&lt;pre&gt;&lt;code class=\&quot;bash\&quot;&gt;$ pip install httpbin\n$ gunicorn httpbin:app\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h2 id=\&quot;Changelog\&quot;&gt;Changelog&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;0.2.0: Added an XML endpoint.  Also fixes several bugs with unicode, CORS headers, digest auth, and more.&lt;/li&gt;\n&lt;li&gt;0.1.2: Fix a couple Python3 bugs with the random byte endpoints, fix a bug when uploading files without a Content-Type header set.&lt;/li&gt;\n&lt;li&gt;0.1.1: Added templates as data in setup.py&lt;/li&gt;\n&lt;li&gt;0.1.0: Added python3 support and (re)publish on PyPI&lt;/li&gt;\n&lt;/ul&gt;\n\n\n&lt;h2 id=\&quot;AUTHOR\&quot;&gt;AUTHOR&lt;/h2&gt;\n\n&lt;p&gt;A &lt;a href=\&quot;https://www.runscope.com/community\&quot;&gt;Runscope Community Project&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Originally created by &lt;a href=\&quot;http://kennethreitz.com/\&quot;&gt;Kenneth Reitz&lt;/a&gt;.&lt;/p&gt;\n\n&lt;h2 id=\&quot;SEE-ALSO\&quot;&gt;SEE ALSO&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=\&quot;https://www.hurl.it\&quot;&gt;Hurl.it&lt;/a&gt; - Make HTTP requests.&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&quot;http://requestb.in\&quot;&gt;RequestBin&lt;/a&gt; - Inspect HTTP requests.&lt;/p&gt;\n&lt;p&gt;&lt;a href=\&quot;http://python-requests.org\&quot; data-bare-link=\&quot;true\&quot;&gt;http://python-requests.org&lt;/a&gt;&lt;/p&gt;\n\n&lt;/div&gt;\n\n\n\n&lt;/body&gt;\n&lt;/html&gt;&quot;</code></pre>
<p>where <code>req</code> is a <code>response</code>-object.</p>
<p>The resulting do-it-all function would be:</p>
<pre class="r"><code>view_httr &lt;- function(req) {

   # Cast the session to character
   stopifnot(class(req) == &#39;response&#39;)
   s_code &lt;- httr::content(req, as = &#39;text&#39;)
   
   # Make a temporary file, fill it with text
   temp_file &lt;- tempfile(fileext = &#39;.html&#39;)

   f &lt;- file(temp_file, open = &#39;w&#39;)
   write(s_code, f)
   close(f)
   
   browseURL(temp_file)

   # Wait a while, then delete it
   Sys.sleep(3)
   unlink(temp_file)
}

view_httr(req)</code></pre>
<p>And voilà! (2)</p>
</div>
<div id="generalizing-with-s3-objects" class="section level3">
<h3>Generalizing with S3 objects</h3>
<p>So far, we wrote two functions:</p>
<ul>
<li><code>view_rvest</code>, operating on <code>text</code> objects</li>
<li><code>view_httr</code>, operating on <code>request</code> objects</li>
</ul>
<p>We would like to have a single function which elegantly deals with both cases, and allows for easy extensions.</p>
<p>Either we write a wrapper, and distinguish between the two with an <code>if</code>, or we use the <a href="https://adv-r.hadley.nz/s3.html">S3 object</a> system in R.</p>
<p>It is actually very simple and hackish, but it works well!</p>
<p>In short, we write a <strong>generic</strong> method, which then calls (<strong>dispatches</strong>) the appropriate method for the object type.<br />
The generic method will be seen by the user, the following methods will be, in general, hidden.</p>
<pre class="r"><code>view_html &lt;- function(x) {
   UseMethod(&#39;view_html&#39;, x)
}</code></pre>
<p>What it does when called, is to grab the class of <code>x</code>, and call the method named as <code>view_html.class</code> (where, of course, class is <code>class(x)</code>).<br />
So, we just need to rename:</p>
<ul>
<li><code>view_httr</code> to <code>view_html.response</code> (as <code>x</code> is a <code>response</code>, from <code>httr</code>)</li>
<li><code>view_rvest</code> to <code>view_html.session</code> (as <code>x</code> is a <code>session</code>, from <code>rvest</code>)</li>
</ul>
<p>To be more compact, we can also introduce the <code>view_html.character</code> method which writes character vectors to disk and opens a browser.</p>
<p>Finally, here are the resulting methods:</p>
<!-- ```{r, eval = FALSE}
view_html <- function(x) {
   UseMethod('view_html', x)
}
view_html.session <- function(s) {
   s_tree <- xml2::read_html(s)
   s_code <- as.character(s_tree)
   
   view_html(s_code)
}
view_html.response <- function(resp) {
   s_code <- httr::content(resp, as = 'text')
   
   view_html(s_code)
}

view_html.character <- function(text) {
   temp_file <- tempfile(fileext = '.html')
   
   print(paste('Created:', temp_file))
   
   f <- file(temp_file, open = 'w')
   write(text, f)
   close(f)
   
   browseURL(temp_file)
   Sys.sleep(3)
   unlink(temp_file)
}``` -->
<p>{{<gist e3f91067a7d6e70d238af5da9c03b892>}}</p>
<p>The “smart” calls:</p>
<pre class="r"><code>view_html(s)
view_html(req)
view_html(&#39;test&#39;)</code></pre>
<p>Thank you for reading!</p>
</div>
